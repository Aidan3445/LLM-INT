{
  "version": "1",
  "metadata": {
    "marimo_version": "0.16.5"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "HjkX",
      "code_hash": "9383b8797ac498eca73a3b02d7833e2c",
      "outputs": [
        {
          "type": "data",
          "data": {
            "application/json": "{\"theme\": \"medieval castle\", \"title\": \"Dinner Time in the Tower\", \"goal\": \"Reach the dining room before dinner gets cold\", \"rooms\": [{\"id\": \"tower_bedroom\", \"name\": \"Tower Bedroom\", \"description\": \"A bedroom atop a tall tower with stone walls dimly lit by flickering candles. Through the window you see snow-capped mountains in the distance. The air is cold and still.\", \"items\": [{\"id\": \"bed\", \"name\": \"four-poster bed\", \"description\": \"A large bed with heavy curtains\", \"searchable\": true, \"contains\": []}, {\"id\": \"closet\", \"name\": \"wooden closet\", \"description\": \"A tall wooden closet with ornate carvings\", \"locked\": true, \"key_required\": \"closet_key\", \"contains\": [\"note_from_queen\"]}, {\"id\": \"dresser\", \"name\": \"oak dresser\", \"description\": \"A dresser with three drawers - top, middle, and bottom\", \"drawers\": [{\"id\": \"top_drawer\", \"name\": \"top drawer\", \"locked\": false, \"contains\": [\"note_from_king\"]}, {\"id\": \"middle_drawer\", \"name\": \"middle drawer\", \"locked\": true, \"lock_type\": \"combination\", \"combination\": \"476\", \"contains\": [\"closet_key\"]}, {\"id\": \"bottom_drawer\", \"name\": \"bottom drawer\", \"locked\": false, \"contains\": []}]}, {\"id\": \"note_from_king\", \"name\": \"letter from the King\", \"description\": \"A letter addressed to 'Our Dearest Daughter'\", \"readable\": true, \"text\": \"My dearest daughter, remember that Philip always serves us faithfully. The numbers of our family are important: I was born in year 476. Love, Father the King\"}, {\"id\": \"note_from_queen\", \"name\": \"letter from the Queen\", \"description\": \"A letter with the Queen's seal\", \"readable\": true, \"text\": \"My precious daughter, never forget who you are - a princess of this realm. Your father and I await you at dinner. Love, Mother the Queen\"}, {\"id\": \"trapdoor\", \"name\": \"wooden trapdoor\", \"description\": \"A trapdoor in the corner of the room leading down\", \"locked\": true, \"key_required\": \"closet_key\", \"leads_to\": \"spiral_staircase\", \"direction\": \"south\", \"aliases\": [\"down\", \"trapdoor\"]}], \"exits\": []}, {\"id\": \"spiral_staircase\", \"name\": \"Spiral Staircase\", \"description\": \"A long spiral staircase winding down the interior of the tower. Stone walls are lined with portrait paintings, each with a nameplate and description beneath.\", \"items\": [{\"id\": \"portrait_philip\", \"name\": \"portrait of Philip\", \"description\": \"A painting of a stern man in servant's clothes\", \"readable\": true, \"text\": \"Philip - Head Butler. Responsible for maintaining the household and overseeing meal service.\"}, {\"id\": \"portrait_jack\", \"name\": \"portrait of young Jack\", \"description\": \"A painting of a sad-looking young boy\", \"readable\": true, \"text\": \"Jack - Stable Boy. Orphaned at age 7. Parents rest in the castle graveyard. Works hard caring for the horses.\"}, {\"id\": \"portrait_margaret\", \"name\": \"portrait of Lady Margaret\", \"description\": \"A painting of an elegant noblewoman\", \"readable\": true, \"text\": \"Lady Margaret - Court Advisor. Known for her wisdom and connection to the royal family.\"}, {\"id\": \"locked_door\", \"name\": \"heavy oak door\", \"description\": \"A sturdy door at the bottom of the staircase with an ornate lock\", \"locked\": true, \"lock_type\": \"riddle\", \"riddle_questions\": [{\"question\": \"Who does the dishes?\", \"answer\": \"philip\", \"hint\": \"Check the portraits for someone who works in the household\"}, {\"question\": \"Where is Jack's father?\", \"answer\": \"graveyard\", \"hint\": \"Read Jack's portrait carefully\"}, {\"question\": \"Who are you?\", \"answer\": \"princess\", \"hint\": \"The letters in your bedroom might remind you\"}], \"leads_to\": \"dining_room\"}], \"exits\": [{\"direction\": \"north\", \"leads_to\": \"tower_bedroom\", \"locked\": false, \"aliases\": [\"up\", \"upstairs\"]}]}, {\"id\": \"dining_room\", \"name\": \"Grand Dining Room\", \"description\": \"A magnificent dining hall with a long table set for a feast. The King and Queen sit at the head of the table, smiling warmly. Candles illuminate platters of delicious food.\", \"items\": [{\"id\": \"feast\", \"name\": \"royal feast\", \"description\": \"A wonderful spread of food - roasted meats, fresh bread, fruits, and desserts\"}], \"exits\": [], \"is_goal\": true, \"win_message\": \"You made it to dinner on time! The King and Queen welcome you warmly to the table. Yum! You win!\"}], \"starting_room\": \"tower_bedroom\"}"
          }
        }
      ],
      "console": []
    },
    {
      "id": "HQoX",
      "code_hash": "601a88dbf374a9db3eb0cfdd90114e80",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "wKUW",
      "code_hash": "63efeac1508a778e8d9779440fb8765b",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stdout",
          "text": "\u2713 Compiled example.json -> castle_escape_game.py\n  Rooms: 3\n  Theme: medieval castle\nfrom textworld import GameMaker\nfrom textworld.logic import State, Proposition\nfrom textworld.generator.game import Quest, Event\n\n# Create the game maker\nM = GameMaker()\n\n# Theme: medieval castle\n# Goal: Reach the dining room before dinner gets cold\n\n# === ROOMS ===\ntower_bedroom = M.new_room('Tower Bedroom')\ntower_bedroom.desc = 'A bedroom atop a tall tower with stone walls dimly lit by flickering candles. Through the window you see snow-capped mountains in the distance. The air is cold and still.'\n\nspiral_staircase = M.new_room('Spiral Staircase')\nspiral_staircase.desc = 'A long spiral staircase winding down the interior of the tower. Stone walls are lined with portrait paintings, each with a nameplate and description beneath.'\n\ndining_room = M.new_room('Grand Dining Room')\ndining_room.desc = 'A magnificent dining hall with a long table set for a feast. The King and Queen sit at the head of the table, smiling warmly. Candles illuminate platters of delicious food.'\n\n\n# Connect rooms\n# Connecting via wooden trapdoor (actual direction: south)\n# Aliases from tower_bedroom: down, trapdoor\npath_trapdoor = M.connect(tower_bedroom.south, spiral_staircase.north)\ndoor_trapdoor = M.new_door(path_trapdoor, 'wooden trapdoor')\ndoor_trapdoor.add_property('locked')\n# Connecting via heavy oak door (actual direction: south)\npath_locked_door = M.connect(spiral_staircase.south, dining_room.north)\ndoor_locked_door = M.new_door(path_locked_door, 'heavy oak door')\ndoor_locked_door.add_property('locked')\n\n# === KEYS ===\ncloset_key = M.new(type='k', name='closet key')\n\n# === ITEMS ===\nbed = M.new(type='o', name='four-poster bed')\ntower_bedroom.add(bed)\n\ncloset = M.new(type='c', name='wooden closet')\ncloset.add_property('locked')\ntower_bedroom.add(closet)\n\ndresser = M.new(type='o', name='oak dresser')\ntower_bedroom.add(dresser)\n\n# top drawer (part of the dresser)\ntop_drawer = M.new(type='c', name='top drawer')\ntop_drawer.add_property('closed')\ntower_bedroom.add(top_drawer)\nnote_from_king = M.new(type='o', name='letter from the King')\nnote_from_king.infos.desc = 'My dearest daughter, remember that Philip always serves us faithfully. The numbers of our family are important: I was born in year 476. Love, Father the King'\ntop_drawer.add(note_from_king)\n\n# middle drawer (part of the dresser)\nmiddle_drawer = M.new(type='c', name='middle drawer')\nmiddle_drawer.add_property('locked')\ntower_bedroom.add(middle_drawer)\nmiddle_drawer.add(closet_key)\n\n# bottom drawer (part of the dresser)\nbottom_drawer = M.new(type='c', name='bottom drawer')\nbottom_drawer.add_property('closed')\ntower_bedroom.add(bottom_drawer)\n\nnote_from_queen = M.new(type='o', name='letter from the Queen')\nnote_from_queen.infos.desc = 'My precious daughter, never forget who you are - a princess of this realm. Your father and I await you at dinner. Love, Mother the Queen'\ntower_bedroom.add(note_from_queen)\n\nportrait_philip = M.new(type='o', name='portrait of Philip')\nportrait_philip.infos.desc = 'Philip - Head Butler. Responsible for maintaining the household and overseeing meal service.'\nspiral_staircase.add(portrait_philip)\n\nportrait_jack = M.new(type='o', name='portrait of young Jack')\nportrait_jack.infos.desc = 'Jack - Stable Boy. Orphaned at age 7. Parents rest in the castle graveyard. Works hard caring for the horses.'\nspiral_staircase.add(portrait_jack)\n\nportrait_margaret = M.new(type='o', name='portrait of Lady Margaret')\nportrait_margaret.infos.desc = 'Lady Margaret - Court Advisor. Known for her wisdom and connection to the royal family.'\nspiral_staircase.add(portrait_margaret)\n\nfeast = M.new(type='o', name='royal feast')\ndining_room.add(feast)\n\n\n# === LOCKS AND KEYS ===\n# wooden closet locked by closet_key\nM.add_fact('match', closet_key, closet)\n# wooden trapdoor locked by closet_key\nM.add_fact('match', closet_key, door_trapdoor)\n\n# === PUZZLES ===\n# middle drawer has combination: 476\n\n# heavy oak door has riddle puzzle\n# Q: Who does the dishes? -> A: philip\n# Q: Where is Jack's father? -> A: graveyard\n# Q: Who are you? -> A: princess\n\n\n# === GAME SETUP ===\nM.set_player(tower_bedroom)\n\n# Win condition: Reach dining_room\n# Win message: You made it to dinner on time! The King and Queen welcome you warmly to the table. Yum! You win!\n\n# Create quest: reach the dining room\nquest = Quest(win_events=[\n    Event(conditions={M.new_fact('at', M.player, dining_room)})\n])\nM.quests = [quest]\n\n# === DIRECTION ALIASES ===\n# Map of (room, alias) -> (target_room, actual_direction)\n# Use this in your gameplay interface to translate player commands\nDIRECTION_ALIASES = {\n    ('tower_bedroom', 'down'): ('spiral_staircase', 'south'),\n    ('tower_bedroom', 'trapdoor'): ('spiral_staircase', 'south'),\n}\n\n# === GENERATE GAME ===\ngame = M.build()\n\n# Compile to .ulx file\ngame_file = M.compile('./castle_escape_game.ulx')\nprint(f'Game compiled successfully to: {game_file}')\n\n"
        }
      ]
    }
  ]
}